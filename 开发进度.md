# QQ自动发送消息开发进度

## 2024-03-21 最终版本 V2.0
1. 所有功能已完成并测试通过：
   - 自动打开QQ
   - 自动搜索指定用户
   - 自动点击搜索结果
   - 自动发送带随机码的消息
   - GUI界面支持
   - 定时发送功能
   - 多用户批量发送
   - 配置文件支持

## 功能说明
1. 自动化流程：
   - 启动QQ
   - 识别并点击搜索框
   - 输入目标QQ号
   - 点击搜索结果
   - 自动定位输入框
   - 发送指定格式消息

2. 消息格式：
   - "代码xxx，若请假请忽略此条消息，谢谢。"
   - xxx为100-999之间的随机数字

3. GUI功能：
   - 用户管理（添加/删除用户）
   - 定时设置（可设置具体时间）
   - 立即发送功能
   - 状态显示
   - 批量发送支持

4. 配置文件(config.json)：
   - QQ路径配置
   - 用户列表管理
   - 定时设置
   - 消息模板

## 使用说明
1. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```

2. 运行程序：
   ```bash
   python qq_auto_send_gui.py
   ```

3. 运行要求：
   - QQ已经登录
   - 电脑已连接网络
   - QQ窗口处于正常大小（不要最小化）
   - QQ窗口在最前面

4. GUI使用说明：
   - 添加用户：点击"添加用户"按钮
   - 删除用户：选中用户后点击"删除用户"
   - 立即发送：点击"立即发送"按钮
   - 定时发送：设置时间并启用定时发送

## 技术栈
- Python
- pyautogui (自动化操作)
- opencv-python (图像识别)
- pillow (图像处理)
- tkinter (GUI界面)
- schedule (定时任务)
- threading (多线程支持)

## 注意事项
1. 配置文件(config.json)说明：
   - qq_path: QQ程序路径
   - users: 用户列表
   - schedule: 定时设置
   - message_template: 消息模板

2. 运行注意事项：
   - 需要将搜索框图片(image.png)放在程序同目录下
   - 程序运行时请勿移动鼠标（可能触发pyautogui的安全机制）
   - 定时发送功能运行时请勿关闭程序窗口

## 已解决的问题
1. 搜索框识别准确性
2. 聊天窗口定位
3. 消息发送可靠性
4. 多用户批量发送
5. 定时任务准确性
6. GUI界面易用性

## 后续优化方向
1. 添加日志记录功能
2. 添加发送历史记录
3. 添加消息模板管理
4. 添加用户分组功能 